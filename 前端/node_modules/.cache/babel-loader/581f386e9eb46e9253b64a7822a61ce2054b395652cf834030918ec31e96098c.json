{"ast":null,"code":"import _regenerator from \"D:/Desktop/\\u9879\\u76EE/\\u4E2A\\u4EBA\\u535A\\u5BA2\\u7CFB\\u7EDF/\\u524D\\u7AEF/node_modules/@babel/runtime/helpers/esm/regenerator.js\";\nimport _asyncToGenerator from \"D:/Desktop/\\u9879\\u76EE/\\u4E2A\\u4EBA\\u535A\\u5BA2\\u7CFB\\u7EDF/\\u524D\\u7AEF/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.push.js\";\nexport default {\n  name: 'BlogEdit',\n  data: function data() {\n    return {\n      isEdit: false,\n      blogForm: {\n        title: '',\n        content: ''\n      },\n      rules: {\n        title: [{\n          required: true,\n          message: '请输入标题',\n          trigger: 'blur'\n        }],\n        content: [{\n          required: true,\n          message: '请输入内容',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  created: function created() {\n    var blogId = this.$route.query.id;\n    if (blogId) {\n      this.isEdit = true;\n      this.fetchBlogDetail(blogId);\n    }\n  },\n  methods: {\n    fetchBlogDetail: function fetchBlogDetail(id) {\n      var _this = this;\n      return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee() {\n        var _yield$_this$$http$ge, data, _t;\n        return _regenerator().w(function (_context) {\n          while (1) switch (_context.n) {\n            case 0:\n              _context.p = 0;\n              _context.n = 1;\n              return _this.$http.get(\"/api/blogs/\".concat(id));\n            case 1:\n              _yield$_this$$http$ge = _context.v;\n              data = _yield$_this$$http$ge.data;\n              _this.blogForm = data;\n              _context.n = 3;\n              break;\n            case 2:\n              _context.p = 2;\n              _t = _context.v;\n              _this.$message.error('获取博客详情失败');\n            case 3:\n              return _context.a(2);\n          }\n        }, _callee, null, [[0, 2]]);\n      }))();\n    },\n    submitForm: function submitForm() {\n      var _this2 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee2() {\n        var token, _t2;\n        return _regenerator().w(function (_context2) {\n          while (1) switch (_context2.n) {\n            case 0:\n              _context2.p = 0;\n              _context2.n = 1;\n              return _this2.$refs.blogForm.validate();\n            case 1:\n              if (!_this2.isEdit) {\n                _context2.n = 3;\n                break;\n              }\n              _context2.n = 2;\n              return _this2.$http.put(\"/api/blogs/\".concat(_this2.$route.query.id), _this2.blogForm);\n            case 2:\n              _this2.$message.success('更新成功');\n              _context2.n = 5;\n              break;\n            case 3:\n              token = localStorage.getItem('token');\n              _context2.n = 4;\n              return _this2.$http.post('/api/blogs', _this2.blogForm, {\n                headers: {\n                  'Authorization': \"Bearer \".concat(token)\n                }\n              });\n            case 4:\n              _this2.$message.success('发布成功');\n            case 5:\n              _this2.$router.push('/home/blog-list');\n              _context2.n = 7;\n              break;\n            case 6:\n              _context2.p = 6;\n              _t2 = _context2.v;\n              console.error('操作失败:', _t2);\n              _this2.$message.error(_this2.isEdit ? '更新失败' : '发布失败');\n            case 7:\n              return _context2.a(2);\n          }\n        }, _callee2, null, [[0, 6]]);\n      }))();\n    }\n  }\n};","map":{"version":3,"names":["name","data","isEdit","blogForm","title","content","rules","required","message","trigger","created","blogId","$route","query","id","fetchBlogDetail","methods","_this","_asyncToGenerator","_regenerator","m","_callee","_yield$_this$$http$ge","_t","w","_context","n","p","$http","get","concat","v","$message","error","a","submitForm","_this2","_callee2","token","_t2","_context2","$refs","validate","put","success","localStorage","getItem","post","headers","$router","push","console"],"sources":["src/views/BlogEdit.vue"],"sourcesContent":["<template>\r\n  <div class=\"blog-edit\">\r\n    <el-form :model=\"blogForm\" :rules=\"rules\" ref=\"blogForm\" label-width=\"80px\">\r\n      <el-form-item label=\"标题\" prop=\"title\">\r\n        <el-input v-model=\"blogForm.title\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"内容\" prop=\"content\">\r\n        <el-input type=\"textarea\" v-model=\"blogForm.content\" :rows=\"15\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"submitForm\">{{ isEdit ? '更新' : '发布' }}</el-button>\r\n        <el-button @click=\"$router.back()\">取消</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'BlogEdit',\r\n  data() {\r\n    return {\r\n      isEdit: false,\r\n      blogForm: {\r\n        title: '',\r\n        content: ''\r\n      },\r\n      rules: {\r\n        title: [{ required: true, message: '请输入标题', trigger: 'blur' }],\r\n        content: [{ required: true, message: '请输入内容', trigger: 'blur' }]\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    const blogId = this.$route.query.id\r\n    if (blogId) {\r\n      this.isEdit = true\r\n      this.fetchBlogDetail(blogId)\r\n    }\r\n  },\r\n  methods: {\r\n    async fetchBlogDetail(id) {\r\n      try {\r\n        const { data } = await this.$http.get(`/api/blogs/${id}`)\r\n        this.blogForm = data\r\n      } catch (error) {\r\n        this.$message.error('获取博客详情失败')\r\n      }\r\n    },\r\n    async submitForm() {\r\n      try {\r\n        await this.$refs.blogForm.validate()\r\n        if (this.isEdit) {\r\n          await this.$http.put(`/api/blogs/${this.$route.query.id}`, this.blogForm)\r\n          this.$message.success('更新成功')\r\n        } else {\r\n          const token = localStorage.getItem('token')\r\n          await this.$http.post('/api/blogs', this.blogForm, {\r\n            headers: {\r\n              'Authorization': `Bearer ${token}`\r\n            }\r\n          })\r\n          this.$message.success('发布成功')\r\n        }\r\n        this.$router.push('/home/blog-list')\r\n      } catch (error) {\r\n        console.error('操作失败:', error)\r\n        this.$message.error(this.isEdit ? '更新失败' : '发布失败')\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.blog-edit {\r\n  padding: 20px;\r\n  max-width: 800px;\r\n  margin: 0 auto;\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}